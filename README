General
-------

Hydra is a process management system for starting parallel jobs,
especially MPICH2 jobs. Hydra is designed to natively work with
multiple daemons such as ssh, pbs, slurm and sge. However, in the
current release, only ssh and fork are supported.

More detailed documentation of the internal workings of Hydra are
available on the "Developer Documentation" wiki page:
http://wiki.mcs.anl.gov/mpich2/index.php/Category:Design_Documents

How to use Hydra
----------------

To use hydra, mpich2 needs to be configured with the configure option
--with-pm=hydra.

Once MPICH2 has been built with Hydra, the Hydra commands are in
mpich2/bin, or the bin subdirectory of the install directory if you
have done an install.  You should put this (bin) directory in your
PATH in your .cshrc or .bashrc for usage convenience:

Put in .cshrc:  setenv PATH /home/you/mpich2/bin:$PATH

Put in .bashrc: export PATH=/home/you/mpich2/bin:$PATH

To compile your application use mpicc:

 $ mpicc app.c -o app

Create a file with the names of the machines that you want to run your
job on. This file may or may not include the local machine.

 $ cat hosts

   donner.mcs.anl.gov
   foo.mcs.anl.gov
   shakey.mcs.anl.gov
   terra.mcs.anl.gov

To run your application on these nodes, use mpiexec:

 $ mpiexec -f hosts -n 4 ./app


Environment settings
--------------------

HYDRA_HOST_FILE: This variable points to the default host file to use,
when the "-f" option is not provided to mpiexec.

  For bash:
    export HYDRA_HOST_FILE=<path_to_host_file>/hosts

  For csh/tcsh:
    setenv HYDRA_HOST_FILE <path_to_host_file>/hosts


Bootstrap servers
-----------------

Hydra supports SSH and FORK bootstrap servers to launch processes. You
can pick these through the mpiexec option --bootstrap:

 $ mpiexec --bootstrap ssh -f hosts -n 4 ./app

 (or)

 $ mpiexec --bootstrap fork -f hosts -n 4 ./app

The default bootstrap server is ssh.


X Forwarding
------------

X-forwarding is specific to each bootstrap server. Some servers do it
by default, while some don't. For ssh, this is disabled by default. To
enable it, you should use the option --enable-x to mpiexec.

 $ mpiexec --enable-x -f hosts -n 4 ./app
